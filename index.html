<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" />
    <title>漢字轉換</title>

    <!-- web fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.loli.net/css2?family=Noto+Sans+JP&family=Noto+Sans+SC&family=Noto+Sans+TC&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="kj-converter.css">
    <!--<script src="scripts/converter_main_ORG.js" charset="utf-8"></script>-->
    <script src="kj-converter_main.js" charset="utf-8"></script>
    <script src="kj-scripts/cookie.umd.min.js"></script>

    <script>
      //Javascript for Cookie
      function loadCookie() {

        //Input language
        var input_lang = cookie.get("optionLang", "1");
        document.getElementById("input_ja").checked = true;
        if (Number(input_lang) == 2) {
          document.getElementById("input_zhHans").checked = true;
        } else if (Number(input_lang) == 3) {
          document.getElementById("input_zhHant").checked = true;
        }

        //Pinyin
        var addPinyin = cookie.get("optionPinyin", "0");
        document.getElementById("checkPinyin").checked = false;
        document.getElementById("checkZhuyin").checked = false;

        switch (Number(addPinyin)) {
          case 1:
            document.getElementById("checkPinyin").checked = true;
            document.getElementById("checkZhuyin").checked = false;
            break;
          case 2:
            document.getElementById("checkPinyin").checked = true;
            document.getElementById("checkZhuyin").checked = true;
            break;
        }

        //Pinyin tone
        var pinyinTone = cookie.get("optionPinyinTone", "1");
        document.getElementById("pinyinTone_Mark").checked = true;
        switch (Number(pinyinTone)) {
          case 2:
            document.getElementById("pinyinTone_Num").checked = true;
            break;
          case 3:
            document.getElementById("pinyinTone_None").checked = true;
            break;
        }

        //Pinyin position
        var pinyinPos = cookie.get("optionPinyinPos", "1");
        document.getElementById("pinyinPos_Top").checked = true;
        switch (Number(pinyinPos)) {
          case 2:
            document.getElementById("pinyinPos_Right").checked = true;
            break;
          case 3:
            document.getElementById("pinyinPos_Left").checked = true;
            break;
          case 4:
            document.getElementById("pinyinPos_Bottom").checked = true;
            break;
        }

        var pinyinBegin = cookie.get("optionPinyinBegin", "");
        document.getElementById("pinyinBegin").value = pinyinBegin;

        var pinyinBracketFrom = cookie.get("optionPinyinBracketFrom", "[");
        document.getElementById("pinyinBracketFrom").value = pinyinBracketFrom;

        var pinyinSep = cookie.get("optionPinyinSep", " ");
        document.getElementById("pinyinSep").value = pinyinSep;

        var pinyinBracketTo = cookie.get("optionPinyinBracketTo", "]");
        document.getElementById("pinyinBracketTo").value = pinyinBracketTo;

        var pinyinEnd = cookie.get("optionPinyinEnd", "");
        document.getElementById("pinyinEnd").value = pinyinEnd;

        var checkBracketAtBiaodian = cookie.get("optionBracketAtBiaodian", "0");
        if (Number(checkBracketAtBiaodian) == 0) {
          document.getElementById("checkBracketAtBiaodian").checked = false;
        } else {
          document.getElementById("checkBracketAtBiaodian").checked = true;
        }

        var checkRemoveBiaodian = cookie.get("optionRemoveBiaodian", "0");
        if (Number(checkRemoveBiaodian) == 0) {
          document.getElementById("checkRemoveBiaodian").checked = false;
        } else {
          document.getElementById("checkRemoveBiaodian").checked = true;
        }
        
        //alert("Loaded");
      }

      function getInputLang() {
        var input_lang = 1;
        if (document.getElementById("input_zhHans").checked == true) {
          input_lang = 2;
        } else if (document.getElementById("input_zhHant").checked == true) {
          input_lang = 3;
        }

        return input_lang;
      }
      
      function saveCookie() {

        //Input language
        var input_lang = getInputLang();

        //Pinyin
        var addPinyin = 0;
        if (document.getElementById("checkPinyin").checked == true) {
            addPinyin = 1;
            if (document.getElementById("checkZhuyin").checked == true) {
                addPinyin = 2;
            }
        }

        //Pinyin tone
        var pinyinTone = 1;
        if (document.getElementById("pinyinTone_Num").checked == true) {
          pinyinTone = 2;
        } else if (document.getElementById("pinyinTone_None").checked == true) {
          pinyinTone = 3;
        }

        //Pinyin position
        var pinyinPos = 1;
        if (document.getElementById("pinyinPos_Right").checked == true) {
          pinyinPos = 2;
        } else if (document.getElementById("pinyinPos_Left").checked == true) {
          pinyinPos = 3;
        } else if (document.getElementById("pinyinPos_Bottom").checked == true) {
          pinyinPos = 4;
        }

        //Pinyin brackets and separator
        var pinyinBegin = document.getElementById("pinyinBegin").value;
        var pinyinBracketFrom = document.getElementById("pinyinBracketFrom").value;
        var pinyinSep = document.getElementById("pinyinSep").value;
        var pinyinBracketTo = document.getElementById("pinyinBracketTo").value;
        var pinyinEnd = document.getElementById("pinyinEnd").value;

        var bracketAtBiaodian = 0;
        if (document.getElementById("checkBracketAtBiaodian").checked == true) {
          bracketAtBiaodian = 1;
        }

        var removeBiaodian = 0;
        if (document.getElementById("checkRemoveBiaodian").checked == true) {
          removeBiaodian = 1;
        }


        cookie.set({
          optionLang: input_lang,
          optionPinyin: addPinyin,
          optionPinyinTone: pinyinTone,
          optionPinyinPos: pinyinPos,
          optionPinyinBegin: pinyinBegin,
          optionPinyinBracketFrom: pinyinBracketFrom,
          optionPinyinSep: pinyinSep,
          optionPinyinBracketTo: pinyinBracketTo,
          optionPinyinEnd: pinyinEnd,
          optionBracketAtBiaodian: bracketAtBiaodian,
          optionRemoveBiaodian: removeBiaodian
        });

        alert("端末に設定を保存しました\n在您的设备上设置已保存\n在您的設備上設置已保存\nSetting saved on your device");

      }

      function removeCookie() {

        var result = window.confirm("設定をリセットしますか？\n是否要重置设置？\n是否要重置設置？\nDo you reset the settings?");
        if( result ) {
          cookie.empty();
          alert("設定をクリアしました。ページを更新してください。\n设置已清除了，请刷新页面\n設置已清除了，請刷新頁面\nSettings cleared. Please refresh page.");
        }

      }

      function validatePinyinOptionsPinyin() {
        if (document.getElementById("checkPinyin").checked == false) {
          document.getElementById("checkZhuyin").checked = false;
        }
      }

      function validatePinyinOptionsZhuyin() {
        if (document.getElementById("checkZhuyin").checked == true) {
          document.getElementById("checkPinyin").checked = true;
        }
      }

      // Translation site integration //////////
      function openTranslation(siteName) {

        var elem_input = document.getElementById("input_text");
        //Show error message if no text input
        if (elem_input.value.trim().length == 0){
            alert("テキストを入力してください\n请输入文本\n請輸入文本\nPlease input text");
            return;
        }

        var searchText = "";
        var elemText = elem_input.value;
        var selText = document.getSelection().toString();

        if ((selText.toString().trim().length == 0) || (elemText.indexOf(selText) < 0)){
          searchText = elemText;
        } else {
          searchText = selText;
        }

        searchText = searchText.trim();
        searchText = searchText.replaceAll("\n", "%0A");

        //alert(searchText);

        //Input language
        var input_lang = getInputLang();
        
        switch (siteName) {
          case "google":
            var transFrom = "ja";
            var transTo = "zh-CN";
            if (input_lang != 1) {
              transFrom = "zh-CN";
              transTo = "ja";
            }
            window.open("https://translate.google.co.jp/?sl=" + transFrom + "&tl=" + transTo + "&text=" + searchText, "_blank", "noreferrer");
            break;
          case "baidu":
          var transFrom = "jp";
            var transTo = "zh";
            if (input_lang != 1) {
              transFrom = "zh";
              transTo = "jp";
            }
            window.open("https://fanyi.baidu.com/#" + transFrom + "/" + transTo + "/" + searchText, "_blank", "noreferrer");
            break;
        }

      }

      // Dictionary site integration //////////
      function searchWord(sourceElement, siteOption) {

        var elem_output = document.getElementById(sourceElement);
        //Show error message if no text output
        if (elem_output.value.length == 0){
            alert("漢字変換後にご利用になれます\n汉字转换后可以使用\n漢字轉換後可以使用\nAvailable after Chinese character translation");
            return;
        }

        var searchText = "";
        var elemText = elem_output.value;
        var selText = document.getSelection().toString();

        if ((selText.toString().length == 0) || (elemText.indexOf(selText) < 0)){
          searchText = elemText;
        } else {
          searchText = selText;
        }

        if (sourceElement.indexOf("output_text_ja") != -1) {
          //Japanese
          if (siteOption == 1){
            //Use goo
            window.open("https://dictionary.goo.ne.jp/srch/all/" + searchText + "/m0u/", "_blank", "noreferrer");
          } else {
            //Use Weblio
            window.open("https://cjjc.weblio.jp/content/" + searchText, "_blank", "noreferrer");
          }
        } else {
          //Chinese
          if (siteOption == 1){
            //Use Baidu Hanyu
            window.open("https://hanyu.baidu.com/s?wd=" + searchText, "_blank", "noreferrer", "noreferrer");
          } else {
            //Use Baidu Baike
            window.open("https://baike.baidu.com/item/" + searchText, "_blank", "noreferrer", "noreferrer");
          }
        }

      }

    </script>

  </head>

  <body>


    <h1>日本の漢字・簡体字・繁体字 変換 / ピンイン追加</h1>
    
    <h2>日中漢字変換・ピンイン追加ツール<br />翻訳・辞典サイトへの簡単リンク</h2>

    <p>&nbsp;</p>

    <a name="TOP"></a>

    <h3>変換する漢字を入力</h3>

    <div>
      <h4>漢字を入力<br />输入汉字 | 輸入漢字</h4>
      <textarea id="input_text" name="input_text" class="inputarea" placeholder="テキストを入力 | 输入文本 | 輸入文本"></textarea>
      <br />
      <input id="button_clear_input" type="button" class="button_inactive" value="クリア | 清除" onclick="clearText('input_text');"/>
      <br /><br />
      <input id="button_trans_google" type="button" class="button_inactive" value="Googleで翻訳" onclick="openTranslation('google');"/>
      &nbsp;
      <input id="button_trans_baidu" type="button" class="button_inactive" value="百度で翻訳" onclick="openTranslation('baidu');"/>
      <br/><br/>
    </div>

    <div>
      <h4>入力漢字<br />输入的汉字 | 輸入的漢字</h4>
    </div>

    <div class="radio-button-group mts">
      <div class="item">
        <input id="input_ja" type="radio" name="button-group" class="radio-button" />
        <label for="input_ja">日本の漢字</label>
      </div>
      <div class="item">
        <input id="input_zhHans" type="radio" name="button-group" class="radio-button" />
        <label for="input_zhHans">简体字</label>
      </div>
      <div class="item">
        <input id="input_zhHant" type="radio" name="button-group" class="radio-button" />
        <label for="input_zhHant">繁体字</label>
      </div>
      <br/><br/>
    </div>

    <div>
      <h4>ピンイン<br />拼音 | 拚音</h4>
    </div>

    <div>
      <label class="ECM_CheckboxInput">
        <input class="ECM_CheckboxInput-Input" type="checkbox" id="checkPinyin" name="checkPinyin" onclick="validatePinyinOptionsPinyin()" />
        <span class="ECM_CheckboxInput-DummyInput"></span>
        <span class="ECM_CheckboxInput-LabelText">ピンイン表示 | 显示拼音 | 顯示拼音</span>
      </label>
      <label class="ECM_CheckboxInput">
        <input class="ECM_CheckboxInput-Input" type="checkbox" id="checkZhuyin" name="checkZhuyin" onclick="validatePinyinOptionsZhuyin()" />
        <span class="ECM_CheckboxInput-DummyInput"></span>
        <span class="ECM_CheckboxInput-LabelText">注音 (Bopomofo)</span>
      </label>
    </div>

    <details class="c-accordion">
      <summary class="c-accordion_ttl">さらにオプションを表示<br />更多选择 | 更多選擇</summary>
     
        <div class="c-accordion_txt">
          <h4>拼音: 声調記号<br />调号 | 調號</h4>
          <div class="radio-button-group mts">
            <div class="item">
              <input id="pinyinTone_Mark" type="radio" name="radioPinyinTone" class="radio-button" />
              <label for="pinyinTone_Mark">記号<br />(ǎ)</label>
            </div>
            <div class="item">
              <input id="pinyinTone_Num" type="radio" name="radioPinyinTone" class="radio-button" />
              <label for="pinyinTone_Num">数字<br />(a3)</label>
            </div>
            <div class="item">
              <input id="pinyinTone_None" type="radio" name="radioPinyinTone" class="radio-button" />
              <label for="pinyinTone_None">無<br />(a)</label>
            </div>
          </div>
        </div>

        <div class="c-accordion_txt">
          <h4>拼音: 出力位置<br />输出位置 | 輸出位置</h4>
          <div class="radio-button-group mts">
            <div class="item">
              <input id="pinyinPos_Top" type="radio" name="radioPinyinPos" class="radio-button" />
              <label for="pinyinPos_Top">前行<br />上一行</label>
            </div>
            <div class="item">
              <input id="pinyinPos_Right" type="radio" name="radioPinyinPos" class="radio-button" />
              <label for="pinyinPos_Right">行末<br />行尾</label>
            </div>
            <div class="item">
              <input id="pinyinPos_Left" type="radio" name="radioPinyinPos" class="radio-button" />
              <label for="pinyinPos_Left">行頭<br />行首</label>
            </div>
            <div class="item">
              <input id="pinyinPos_Bottom" type="radio" name="radioPinyinPos" class="radio-button" />
              <label for="pinyinPos_Bottom">次行<br />下一行</label>
            </div>
          </div>
        </div>
        
      <div class="c-accordion_txt">
        <h4>拼音: 括弧と区切り<br />括号和分隔符 | 括號和分隔符</h4>
        <input id="pinyinBegin" type="text" class="narrow" value="" placeholder="行頭" /><input id="pinyinBracketFrom" type="text" class="narrow" value="(" placeholder="括弧" />pīn<input id="pinyinSep" type="text" class="narrow" value=" " placeholder="区切" />yīn<input id="pinyinBracketTo" type="text" class="narrow" value=")" placeholder="括弧" /><input id="pinyinEnd" type="text" class="narrow" value="" placeholder="行末" />
        <p class="notes">※ 区切りの初期値には空白文字に設定されています。<br />
          &nbsp;&nbsp;&nbsp;&nbsp;分隔符的初始值是空格符</p>
        <p class="notes">※ ピンインの行頭・行末に追加する文字を設定できます。<br />
          &nbsp;&nbsp;&nbsp;&nbsp;同一行でExcelに貼り付ける場合はタブが便利です。（入力例: &lt;TAB&gt;）</p>

        <label class="ECM_CheckboxInput">
          <input class="ECM_CheckboxInput-Input" type="checkbox" id="checkBracketAtBiaodian" name="checkBracketAtBiaodian" />
          <span class="ECM_CheckboxInput-DummyInput"></span>
          <span class="ECM_CheckboxInput-LabelText">句読点で括弧を追加<br />在标点符号处添加括号</span>
        </label>

        <label class="ECM_CheckboxInput">
          <input class="ECM_CheckboxInput-Input" type="checkbox" id="checkRemoveBiaodian" name="checkRemoveBiaodian" />
          <span class="ECM_CheckboxInput-DummyInput"></span>
          <span class="ECM_CheckboxInput-LabelText">句読点を削除<br />删除标点符号</span>
        </label>

      </div>
      <div class="c-accordion_txt">
        <input id="button_save_cookie" type="button" class="button_inactive" value="   保存   " onclick="saveCookie();" />
        &nbsp;&nbsp;
        <input id="button_remove_cookie" type="button" class="button_inactive" value="  初期値  " onclick="removeCookie();" />
      </div>
    </details>

    <p>&nbsp;</p>
    
    <div>
      <input id="button_convert" type="button" class="button_default" value="  変換開始 | 开始转换 | 開始轉換  " onclick="convertText();"/>
      <br/><br/>
    </div>

    <p>&nbsp;</p>

    <a name="RESULTS"></a>

    <h3>変換結果</h3>

    <div>
      <h4>日本の漢字&nbsp;<span id="input_badge_ja" class="input_badge">入力言語</span></h4>
      <textarea id="output_text_ja" name="output_text_ja" class="outputarea_ja" placeholder="変換された漢字がここに表示されます"></textarea>
      <br />
      <input id="button_copy_ja" type="button" class="button_inactive" value="すべてコピー" onclick="copyText('output_text_ja');"/>
      &nbsp;
      <input id="button_top" type="button" class="button_default" value=" TOP " onclick="location.href='#TOP'"/>
      <p class="notes">※ はじめに単語を選択してから検索してください</p>
      <input id="button_search_word_ja1" type="button" class="button_inactive" value="goo辞書で検索" onclick="searchWord('output_text_ja', 1);"/>
      &nbsp;
      <input id="button_search_word_ja2" type="button" class="button_inactive" value="Weblioで検索" onclick="searchWord('output_text_ja', 2);"/>
      <br/><br/>
    </div>

    <div>
      <h4>简体字&nbsp;<span id="input_badge_zhHans" class="input_badge">输入的语言</span></h4>
      <textarea id="output_text_zhHans" name="output_text_zhHans" class="outputarea_zhhans" placeholder="此处显示转换后的汉字"></textarea>
      <br />
      <input id="button_copy_zhHans" type="button" class="button_inactive" value="复制所有文本" onclick="copyText('output_text_zhHans');"/>
      &nbsp;
      <input id="button_top" type="button" class="button_default" value=" TOP " onclick="location.href='#TOP'"/>
      <p class="notes">※ 请您首先选择一个单词并进行搜索</p>
      <input id="button_search_word_zhHans1" type="button" class="button_inactive" value="在百度汉语查看" onclick="searchWord('output_text_zhHans', 1);"/>
      &nbsp;
      <input id="button_search_word_zhHans1" type="button" class="button_inactive" value="在百度百科查看" onclick="searchWord('output_text_zhHans', 2);"/>
      <br/><br/>
    </div>

    <div>
      <h4>繁体字&nbsp;<span id="input_badge_zhHant" class="input_badge">輸入的語言</span></h4>
      <textarea id="output_text_zhHant" name="output_text_zhHant" class="outputarea_zhhant" placeholder="此處顯示轉換後的漢字"></textarea>
      <br />
      <input id="button_copy_zhHant" type="button" class="button_inactive" value="複製所有文本" onclick="copyText('output_text_zhHant');"/>
      &nbsp;
      <input id="button_top" type="button" class="button_default" value=" TOP " onclick="location.href='#TOP'"/>
      <p class="notes">※ 請您首先選擇一個單詞並進行搜索</p>
      <input id="button_search_word_zhHant1" type="button" class="button_inactive" value="在百度漢語查看" onclick="searchWord('output_text_zhHant', 1);"/>
      &nbsp;
      <input id="button_search_word_zhHant2" type="button" class="button_inactive" value="在百度百科查看" onclick="searchWord('output_text_zhHant', 2);"/>
      <br/><br/>
    </div>

    <!--
    <div>
      <div id="output_text_feedback"></div>
      <br/><br/>
    </div>
    -->

    <script>
      //Set default values
      window.onload = function() {
        loadCookie();
      }
    </script>

    <input id="button_top" type="button" class="button_default" value=" TOP " onclick="location.href='#TOP'"/>
    <p class="notes"><strong>Special Thanks to : </strong><br />
      たつをさん・Dan Kogaiさん - Kanconvit<br />
      Kaifunyさん - pinyin4js<br /><!-- https://github.com/Kaifuny/pinyin4js -->
      logicmason Mark Wilburさん - pinyin-to-zhuyin<br /><!-- https://github.com/logicmason/pinyin-to-zhuyin -->
    <h2><br /></h2>
  </body>
</html>
